# STENOGRAFFIA APP

Ввиду того что приложение должно быть доступно в любом месте где существует мобильный интернет лучше всего подходит мобильное приложение.
Так как я не обладаю в данный момент достаточными компетенциями для реализации мобильного приложения на всех популярных платформах, поэтому изначально я создам приложение под android, и в случае необходимости и желания после напишу приложение под OS.
Модель приложения выбирается исходя из вышеперечисленных и дополнительных (взаимодействие между пользователями) требований, а так же для упрашения написания под другие платформы. Очевидно использовать модель Клиент-Сервер

Платформа: Mobility 
ОС: Android
Модель: Клиент - Сервер

Размер пользовательской базы: до 200 человек.
Стандартный типаж клиента: 
	Возраст: 18 - 40 лет
	Образование: нет \ гуманитарное,
	Статус: Работает \ Учится


Вприложении можно выделить 4 основных модуля:
1. Модуль работы с складом (Storage)
	a. Просмотр позиций склада
	b. Просмотр параметров позиций склада
	с. Изменение колличества позиций на складе
2. Модуль работы с заказами (Order)
	a. Формирование заказа из позиций на складе
	b. Работа со сформированными заказами
3. Модуль работы с обьектами (Object)
	a. Просмотр параметров обьекта
	b. Контроль состояния обьекта
4. Модуль аутентификации (Auth) [Очевидно что ввиду того что модель клиент - сервер обязывает наличие клиента, который благодоря требованиям должен быть идентифицирован на сервере, для определения местоположения должна существовать иситема аутунтификации и авторитизации клиента на сервере.] 

Дальнейшее планирование архитектуры будет приведено в файлах частей.

Флаги:
CONNECTION_SERVER = 0 / 1 (1 - connect, 0 - disconect) - флаг наличия соедиения с сервером

Как только клиент входит в приложение проверяется:
	1. Вошел ли он в приложение до этого:
		Если нет -> a.
		Если да -> 2.
	2. Проверяется есть ли соедиение с сетью
		Если нет -> Приложение с флагом CONNECTION_SERVER = 0 -> b.
		Если да -> 3.
	3. Проверяется залогинен ли пользователь его где либо кроме данного устройства
		Залогинен -> Вывести ощибку -> a.
		Не залогинен не на одном устройсте -> a.
		Не залогинен нигде кроме этого устройства -> b.

	a. Экран входа
	b. Экран склада

Как только пользователь попадает на экран склада:
	Если стоит флаг CONNECTION_SERVER = 1
		У сервера зарашивается обновленная информация по всем базам данных.
		Запускается сервис обратоки обновления базы данных
	Если сброшен флаг CONNECTION_SERVER = 0
		Ничего не происходит 


Сервисы на клиенте:
	UpdateDataBase: 
		Сервис обновления данных в локальной базе данных.
		При запуске сервиса происходит первичная проверка таблиц, каждая последующая производится через
		минуту, сервис ходит на сервер по \getLastGatabaseUpdate (смотри что это на SwaggerDocs)
		Он выдергивает время обновления каждой таблицы с сервера
		Если время обновления локальной таблицы < время обновления серверной таблицы
		То он дергает эту таблицу с сервера и обновляет локальную в соответствии с ней.


## Network
Поскольку база данных находится на сервере. Должна быть система коннекта и безопасности.
Это проблема. Почему?
Это делает систему не безопасной с точки зрения возможности повлиять на работу фестиваля.

Для того чтобы обеспечить безопасность необходимо иметь права доступа более подробна про права доступа описано в part_users.md, то что там написано реализовано в objects, storage, object.

Большая проблема в том что клиент может остатся без интернета, а часть приложения может оказатся важной, поэтому необходимо рассматривать функции каждой части с точки зрения работы без интернета

### Network Connect
При наличии соединения с сервером должны работать:
1. Модуль работы с складом (Storage)
	a. Просмотр позиций склада
	b. Изменение колличества позиций на складе
2. Модуль работы с заказами (Order)
	a. Формирование заказа из позиций на складе
	b. Работа со сформированными заказами
3. Модуль работы с обьектами (Object)
	a. Просмотр параметров обьекта
4. Модуль аутентификации (Auth)

### Network Disconnect
При отсутствии соединения с сервером приложение должно выполнять функции:
1. Модуль работы с складом (Storage)
	a. Просмотр параметров позиций склада
2. Модуль работы с обьектами (Object)
	a. Просмотр параметров обьекта

Это содержит важную проблему с аутентификацией.
Клиент должен после одной аутентификации оставатся аутентифицированный.
Проблемы две:
	1. Если кто то логинится под тем же аккаунт на другом устройстве:
		Решение: Выкинуть ощибку, что пользователь уже залогинен.
			Проблема: Что если человек не имеет доступ к своему телефону? 
				Решение: Пусть ищет свой, не может найти - пусть пишет админу он имеет возможность разлогинить пользователя.
				Это конечно создает проблему загреженности администратора, и необходимости его постоянного онлайна. 
				Но при размерах пользовательской базы, это не предстовляет серьезной проблемы.
	2. Если кто то начинает пользоватся полномочиями во зло.
		Решение: Нужно ограничить доступ человека к системе максимально быстро.
		Это должно быть сделано администратором с отдельной точки доступа.
		Должна быть возможность откатить изменения сделанные этим пользователем, на какое то время назад.



## Версия 1.0
 
